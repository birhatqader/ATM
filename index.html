<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Financial Management System</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
:root{
  --main:#2563eb;
  --dark:#1e293b;
  --light:#f8fafc;
  --card:#fff;
  --success:#10b981;
  --danger:#ef4444;
  --header-bg: linear-gradient(135deg, #2563eb, #3b82f6);
  --shadow: 0 10px 30px rgba(0,0,0,.12);
}

*{margin:0;padding:0;box-sizing:border-box;font-family:Poppins}
body{background:#f1f5f9;}

/* LOGIN */
#loginBox{
  max-width:400px;
  margin:80px auto;
  padding:40px;
  background:var(--card);
  border-radius:16px;
  box-shadow:var(--shadow);
  text-align:center;
  transition:0.3s;
}
#loginBox:hover{transform:translateY(-5px);}

/* LAYOUT */
.app{display:flex;min-height:100vh;flex-wrap:nowrap;}

/* SIDEBAR */
.sidebar{
  width:240px;
  background:var(--dark);
  color:#fff;
  padding:20px;
  display:flex;
  flex-direction:column;
  justify-content:flex-start;
  flex-shrink:0;
}
.sidebar h2{
  text-align:center;
  margin-bottom:30px;
  font-size:1.5rem;
  letter-spacing:1px;
}
.menu button{
  width:100%;
  background:none;
  border:none;
  color:#fff;
  padding:14px 12px;
  margin:6px 0;
  border-radius:12px;
  cursor:pointer;
  text-align:left;
  font-weight:500;
  transition:0.3s;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}
.menu button:hover,.menu button.active{
  background:var(--main);
  box-shadow:0 4px 15px rgba(0,0,0,0.2);
}

/* MAIN */
.main{flex:1;padding:30px 25px 50px 25px;min-width:0;}

/* CARD */
.card{
  background:var(--card);
  padding:30px 25px;
  border-radius:16px;
  box-shadow:var(--shadow);
  margin-bottom:25px;
  transition:0.3s;
  overflow-x:auto;
}
.card:hover{transform:translateY(-5px);}
.card h2{
  font-size:1.6rem;
  margin-bottom:20px;
  color:var(--dark);
}
.card h3{
  font-size:1.2rem;
  margin-bottom:15px;
  color:var(--dark);
}

/* FORM */
input, select{
  width:100%;
  padding:12px;
  border:1px solid #ccc;
  border-radius:12px;
  margin:8px 0 16px;
  font-size:1rem;
  transition:0.2s;
}
input:focus, select:focus{border-color:var(--main); outline:none;}
button{
  padding:12px;
  background:var(--main);
  border:none;
  color:white;
  border-radius:12px;
  cursor:pointer;
  font-weight:600;
  font-size:1rem;
  transition:0.3s;
}
button:hover{opacity:.9; transform:translateY(-2px);}
.reset-btn{
  background:#ef4444;
  margin-top:20px;
  width:100%;
}

/* TABLE */
table{
  width:100%;
  border-collapse:collapse;
  margin-top:15px;
  font-size:0.95rem;
  border-radius:12px;
  overflow:hidden;
  box-shadow:0 4px 12px rgba(0,0,0,.05);
}
th,td{
  padding:12px;
  border-bottom:1px solid #ddd;
  text-align:center;
  word-break:break-word;
}
th{
  background:var(--header-bg);
  color:#fff;
  font-weight:600;
}
.green{color:var(--success); font-weight:600;}
.red{color:var(--danger); font-weight:600;}
.hidden{display:none}

/* REPORT */
.report-grid{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
  gap:20px;
  margin-bottom:25px;
}
.report-box{
  background:#f8fafc;
  padding:20px;
  border-radius:12px;
  text-align:center;
  border-left:6px solid var(--main);
  transition:0.3s;
  min-width:180px;
}
.report-box:hover{transform:translateY(-5px); box-shadow:var(--shadow);}
.report-box h3{
  font-size:14px;
  color:#64748b;
  margin-bottom:8px;
}
.report-box p{
  font-size:22px;
  font-weight:700;
  margin-top:5px;
}

/* RESPONSIVE */
@media(max-width:1100px){
  .app{flex-direction:column;}
  .sidebar{width:100%;display:flex;flex-direction:row;overflow-x:auto;}
  .menu button{flex:1; text-align:center; margin:5px;}
  .main{padding:20px;}
}
@media(max-width:600px){
  #loginBox{margin:50px 10px;padding:30px;}
  input, select, button{font-size:0.9rem;padding:10px;}
  .card{padding:20px;}
  .card h2{font-size:1.4rem;}
  .card h3{font-size:1rem;}
  table th, table td{padding:8px;font-size:0.85rem;}
  .report-box{padding:15px; font-size:0.9rem;}
}
</style>
</head>
<body>

<!-- LOGIN -->
<div id="loginBox">
<h2>Admin Login</h2><br>
<input id="username" placeholder="Username">
<input id="password" type="password" placeholder="password">
<button onclick="login()">Login</button>
</div>

<!-- APP -->
<div id="app" class="hidden app">

<!-- SIDEBAR -->
<div class="sidebar">
<h2>üíº Finance</h2>
<div class="menu">
<button onclick="show('dash', event)" class="active">üìä Dashboard</button>
<button onclick="show('deposit', event)">üí∞ Deposit</button>
<button onclick="show('emp', event)">üë® Employees</button>
<button onclick="show('empAcc', event)">üë® Employee Accounts</button>
<button onclick="show('com', event)">üè¢ Companies</button>
<button onclick="show('comAcc', event)">üè¢ Company Accounts</button>
<button onclick="show('pay', event)">üèß Payments</button>
<button onclick="show('rep', event)">üìÑ Reports</button>
</div>
</div>

<!-- MAIN -->
<div class="main">

<!-- DASHBOARD -->
<div id="dash" class="page card">
<h2>Dashboard</h2>
<h3>ATM Balance: <span id="atmBalance">$0</span></h3>
<canvas id="chart"></canvas>
<button class="reset-btn" onclick="resetSystem()">üóëÔ∏è Reset System</button>
</div>

<!-- DEPOSIT -->
<div id="deposit" class="page card hidden">
<h2>Deposit</h2>
<input id="depositAmount" type="number" placeholder="Amount">
<input id="depositDate" type="datetime-local">
<button onclick="depositATM()">Add Money</button>
</div>

<!-- EMPLOYEES -->
<div id="emp" class="page card hidden">
<h2>Employees</h2>
<input id="empName" placeholder="Name">
<input id="empSalary" type="number" placeholder="Salary">
<button onclick="addEmployee()">Add</button>
<div id="empList"></div>
</div>

<!-- EMPLOYEE ACCOUNTS -->
<div id="empAcc" class="page card hidden">
<h2>Employee Accounts</h2>
<select id="selectEmp" onchange="renderEmployeeAccounts()">
<option value="">-- Select Employee --</option>
</select>
<div id="empAccounts"></div>
</div>

<!-- COMPANIES -->
<div id="com" class="page card hidden">
<h2>Companies</h2>
<input id="comName" placeholder="Name">
<input id="comProduct" placeholder="Product">
<input id="comPrice" type="number" placeholder="Price">
<button onclick="addCompany()">Add</button>
<div id="comList"></div>
</div>

<!-- COMPANY ACCOUNTS -->
<div id="comAcc" class="page card hidden">
<h2>Company Accounts</h2>
<select id="selectCom" onchange="renderCompanyAccounts()">
<option value="">-- Select Company --</option>
</select>
<div id="comAccounts"></div>
</div>

<!-- PAYMENTS -->
<div id="pay" class="page card hidden">
<h2>ATM Payments</h2>
<select id="atmType" onchange="updateATMSelect()">
<option value="emp">Employee</option>
<option value="com">Company</option>
</select>
<select id="atmTarget"></select>
<input id="atmAmount" type="number" placeholder="Amount">
<input id="atmDate" type="datetime-local">
<button onclick="addATM()">Pay</button>
</div>

<!-- REPORT -->
<div id="rep" class="page card hidden">
<h2>Financial Report</h2>
<div class="report-grid" id="reportSummary"></div>
<h3>Full Transaction Sheet</h3>
<table id="reportTable"></table>
</div>

</div>
</div>

<script>
// ADMIN LOGIN
const ADMIN={user:"admin",pass:"1234"};
let employees=[], companies=[], atm=[], deposits=[], atmMoney=0;
const chartCanvas=document.getElementById("chart");

// LOGIN
function login(){
  if(username.value===ADMIN.user && password.value===ADMIN.pass){
    loginBox.classList.add("hidden");
    app.classList.remove("hidden");
    load();
    renderAll();
  }else alert("Wrong Login");
}

// NAVIGATION
function show(id,event){
  document.querySelectorAll(".page").forEach(p=>p.classList.add("hidden"));
  document.getElementById(id).classList.remove("hidden");
  document.querySelectorAll(".menu button").forEach(b=>b.classList.remove("active"));
  event.target.classList.add("active");
  if(id==="rep") makeReport();
  if(id==="empAcc") renderEmployeeAccounts();
  if(id==="comAcc") renderCompanyAccounts();
}

// STORAGE
function save(){ localStorage.setItem("finance",JSON.stringify({employees,companies,atm,deposits,atmMoney})); }
function load(){ let d=JSON.parse(localStorage.getItem("finance")); if(!d) return; employees=d.employees||[]; companies=d.companies||[]; atm=d.atm||[]; deposits=d.deposits||[]; atmMoney=d.atmMoney||0; }

// BALANCE
function updateBalance(){ atmBalance.innerText="$"+atmMoney; }

// DEPOSIT
function depositATM(){ 
  if(!depositAmount.value) return; 
  let amt=+depositAmount.value; 
  atmMoney+=amt; 
  deposits.push({amount:amt,dateTime:depositDate.value}); 
  save(); renderAll(); 
  depositAmount.value=""; depositDate.value=""; 
}

/* EMPLOYEES CRUD */
let editingEmp=-1;
function addEmployee(){ 
  if(!empName.value||!empSalary.value) return; 
  if(editingEmp>-1){
    employees[editingEmp]={name:empName.value,salary:+empSalary.value};
    editingEmp=-1;
  }else{
    employees.push({name:empName.value,salary:+empSalary.value}); 
  }
  save(); renderAll(); updateEmployeeSelect(); renderEmployeeList();
  empName.value=""; empSalary.value="";
}

function editEmployee(i){
  empName.value=employees[i].name;
  empSalary.value=employees[i].salary;
  editingEmp=i;
}

function deleteEmployee(i){
  if(!confirm("Delete this employee?")) return;
  employees.splice(i,1);
  save(); renderAll(); updateEmployeeSelect(); renderEmployeeList();
}

function updateEmployeeSelect(){
  let s="<option value=''>-- Select Employee --</option>";
  employees.forEach((e,i)=>s+=`<option value="${i}">${e.name}</option>`);
  document.getElementById("selectEmp").innerHTML=s;
}

function renderEmployeeList(){
  let html="<table><tr><th>Name</th><th>Salary</th><th>Actions</th></tr>";
  employees.forEach((e,i)=>html+=`<tr>
    <td>${e.name}</td><td>$${e.salary}</td>
    <td>
      <button onclick="editEmployee(${i})">‚úèÔ∏è Edit</button>
      <button onclick="deleteEmployee(${i})">üóëÔ∏è Delete</button>
    </td>
  </tr>`);
  html+="</table>";
  document.getElementById("empList").innerHTML=html;
}

/* COMPANIES CRUD */
let editingCom=-1;
function addCompany(){ 
  if(!comName.value||!comPrice.value) return; 
  if(editingCom>-1){
    companies[editingCom]={name:comName.value,product:comProduct.value,price:+comPrice.value};
    editingCom=-1;
  }else{
    companies.push({name:comName.value,product:comProduct.value,price:+comPrice.value}); 
  }
  save(); renderAll(); updateCompanySelect(); renderCompanyList();
  comName.value=""; comProduct.value=""; comPrice.value="";
}

function editCompany(i){
  comName.value=companies[i].name;
  comProduct.value=companies[i].product;
  comPrice.value=companies[i].price;
  editingCom=i;
}

function deleteCompany(i){
  if(!confirm("Delete this company?")) return;
  companies.splice(i,1);
  save(); renderAll(); updateCompanySelect(); renderCompanyList();
}

function updateCompanySelect(){
  let s="<option value=''>-- Select Company --</option>";
  companies.forEach((c,i)=>s+=`<option value="${i}">${c.name}</option>`);
  document.getElementById("selectCom").innerHTML=s;
}

function renderCompanyList(){
  let html="<table><tr><th>Name</th><th>Product</th><th>Price</th><th>Actions</th></tr>";
  companies.forEach((c,i)=>html+=`<tr>
    <td>${c.name}</td><td>${c.product}</td><td>$${c.price}</td>
    <td>
      <button onclick="editCompany(${i})">‚úèÔ∏è Edit</button>
      <button onclick="deleteCompany(${i})">üóëÔ∏è Delete</button>
    </td>
  </tr>`);
  html+="</table>";
  document.getElementById("comList").innerHTML=html;
}

/* EMPLOYEE ACCOUNTS */
function renderEmployeeAccounts(){ 
  let empIndex=selectEmp.value;
  if(empIndex===""){ 
    let html=`<table><tr><th>Name</th><th>Salary</th><th>Total Paid</th></tr>`;
    employees.forEach((e,i)=>{
      let paid=atm.filter(a=>a.type==="emp" && a.index===i).reduce((sum,x)=>sum+x.amount,0);
      html+=`<tr><td>${e.name}</td><td>$${e.salary}</td><td>$${paid}</td></tr>`;
    });
    html+=`</table>`; 
    document.getElementById("empAccounts").innerHTML=html;
  }else{
    let e=employees[empIndex];
    let empATM=atm.filter(a=>a.type==="emp" && a.index==empIndex);
    let paid=empATM.reduce((sum,x)=>sum+x.amount,0);
    let html=`<h3>${e.name}</h3>`;
    html+=`<p>Salary: $${e.salary}</p>`;
    html+=`<p>Total Paid: $${paid}</p>`;
    html+=`<p>Remaining: $${e.salary - paid}</p>`;
    if(empATM.length>0){
      html+=`<h4>Payments:</h4><table><tr><th>Amount</th><th>Date & Time</th></tr>`;
      empATM.forEach(p=>html+=`<tr><td>$${p.amount}</td><td>${p.dateTime}</td></tr>`);
      html+=`</table>`;
    }
    document.getElementById("empAccounts").innerHTML=html;
  }
}

/* COMPANY ACCOUNTS */
function renderCompanyAccounts(){ 
  let comIndex=selectCom.value;
  if(comIndex===""){ 
    let html=`<table><tr><th>Name</th><th>Product</th><th>Price</th><th>Total Paid</th></tr>`;
    companies.forEach((c,i)=>{
      let paid=atm.filter(a=>a.type==="com" && a.index===i).reduce((sum,x)=>sum+x.amount,0);
      html+=`<tr><td>${c.name}</td><td>${c.product}</td><td>$${c.price}</td><td>$${paid}</td></tr>`;
    });
    html+=`</table>`; 
    document.getElementById("comAccounts").innerHTML=html;
  }else{
    let c=companies[comIndex];
    let comATM=atm.filter(a=>a.type==="com" && a.index==comIndex);
    let paid=comATM.reduce((sum,x)=>sum+x.amount,0);
    let html=`<h3>${c.name}</h3>`;
    html+=`<p>Product: ${c.product}</p>`;
    html+=`<p>Price: $${c.price}</p>`;
    html+=`<p>Total Paid: $${paid}</p>`;
    html+=`<p>Remaining: $${c.price - paid}</p>`;
    if(comATM.length>0){
      html+=`<h4>Payments:</h4><table><tr><th>Amount</th><th>Date & Time</th></tr>`;
      comATM.forEach(p=>html+=`<tr><td>$${p.amount}</td><td>${p.dateTime}</td></tr>`);
      html+=`</table>`;
    }
    document.getElementById("comAccounts").innerHTML=html;
  }
}

/* PAYMENTS */
function updateATMSelect(){ 
  let s=""; 
  if(atmType.value==="emp"){ employees.forEach((e,i)=>s+=`<option value="${i}">${e.name}</option>`); } 
  if(atmType.value==="com"){ companies.forEach((c,i)=>s+=`<option value="${i}">${c.name}</option>`); } 
  atmTarget.innerHTML=s; 
}

function addATM(){ 
  if(!atmAmount.value) return;
  let amt=+atmAmount.value;
  if(amt>atmMoney){ alert("Not enough money!"); return; }
  atmMoney-=amt;
  atm.push({type:atmType.value,index:+atmTarget.value,amount:amt,dateTime:atmDate.value});
  save(); renderAll(); atmAmount.value=""; atmDate.value="";
}

/* REPORT */
function makeReport(){ 
  let emp=0, com=0, dep=0;
  atm.forEach(a=>{ if(a.type==="emp") emp+=a.amount; if(a.type==="com") com+=a.amount; });
  deposits.forEach(d=>dep+=d.amount);
  let profit=dep-(emp+com);
  reportSummary.innerHTML=`<div class="report-box"><h3>ATM Balance</h3><p>$${atmMoney}</p></div>
  <div class="report-box"><h3>Total Deposits</h3><p>$${dep}</p></div>
  <div class="report-box"><h3>Employee Payments</h3><p>$${emp}</p></div>
  <div class="report-box"><h3>Company Payments</h3><p>$${com}</p></div>
  <div class="report-box"><h3>Remaining Profit</h3><p>$${profit}</p></div>`;
  let t=`<tr><th>Type</th><th>Name</th><th>Amount</th><th>Date & Time</th></tr>`;
  deposits.forEach(d=>t+=`<tr><td>Deposit</td><td>ATM</td><td class="green">$${d.amount}</td><td>${d.dateTime}</td></tr>`);
  atm.forEach(a=>{ let name=""; if(a.type==="emp") name=employees[a.index]?.name; if(a.type==="com") name=companies[a.index]?.name; t+=`<tr><td>${a.type}</td><td>${name}</td><td class="red">-$${a.amount}</td><td>${a.dateTime}</td></tr>`; });
  reportTable.innerHTML=t;
}

/* CHART */
let chart;
function updateChart(){ 
  let emp=0, com=0;
  atm.forEach(a=>{ if(a.type==="emp") emp+=a.amount; if(a.type==="com") com+=a.amount; });
  if(chart) chart.destroy();
  chart=new Chart(chartCanvas,{type:"bar",data:{labels:["Employees","Companies"],datasets:[{label:"Payments",data:[emp,com],backgroundColor:["#2563eb","#10b981"]}]}}); 
}

/* RESET */
function resetSystem(){ 
  if(!confirm("Are you sure? All data will be lost.")) return; 
  employees=[]; companies=[]; atm=[]; deposits=[]; atmMoney=0; 
  localStorage.removeItem("finance"); renderAll(); updateEmployeeSelect(); updateCompanySelect();
  renderEmployeeList(); renderCompanyList();
  alert("All records cleared!"); 
}

/* INIT */
function renderAll(){ 
  updateBalance(); updateATMSelect(); makeReport(); updateChart(); renderEmployeeAccounts(); renderCompanyAccounts(); 
  updateEmployeeSelect(); updateCompanySelect(); renderEmployeeList(); renderCompanyList();
}
</script>
</body>
</html>

